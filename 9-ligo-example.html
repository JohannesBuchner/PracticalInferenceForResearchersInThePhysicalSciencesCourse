

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>LIGO Gravitational Wave Analysis &mdash; MCI-course 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/icon.ico"/>
  
  
  
    <link rel="canonical" href="https://johannesbuchner.github.io/UltraNest/9-ligo-example.html"/>
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> MCI-course
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="preliminaries.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="BooksAndPapers.html">Reading material</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MCI-course</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>LIGO Gravitational Wave Analysis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="LIGO-Gravitational-Wave-Analysis">
<h1>LIGO Gravitational Wave Analysis<a class="headerlink" href="#LIGO-Gravitational-Wave-Analysis" title="Permalink to this headline">¶</a></h1>
<p>Gravitational event GW170817 is a binary neutron merger event.</p>
<p>Here is a short youtube video for what it is about:</p>
<p><a class="reference external" href="http://www.youtube.com/watch?v=EtIkOjq0_50"><img alt="Introduction to GW170817" src="http://img.youtube.com/vi/EtIkOjq0_50/0.jpg" /></a></p>
<p>Its chirp wave which was detected with three gravitational wave detectors (H,L,V), allowing constraining:</p>
<ul class="simple">
<li><p>th position on the sky where it originated</p></li>
<li><p>distance</p></li>
<li><p>time of event</p></li>
<li><p>masses of the two progenitors</p></li>
</ul>
<p>If you are interested, you can find out more about the science here <a class="reference external" href="https://www.ligo.org/detections/GW170817.php">https://www.ligo.org/detections/GW170817.php</a> and in one of the many press releases and papers.</p>
<p>We will try to do our own analysis of the chirp signal, with the real data.</p>
<p>The analysis is based on pycbc examples, find out more on the pycbc websites:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pycbc.org/pycbc/latest/html/inference.html">https://pycbc.org/pycbc/latest/html/inference.html</a></p></li>
<li><p><a class="reference external" href="https://github.com/gwastro/PyCBC-Tutorials/blob/master/tutorial/inference_0_Overview.ipynb">https://github.com/gwastro/PyCBC-Tutorials/blob/master/tutorial/inference_0_Overview.ipynb</a></p></li>
<li><p><a class="reference external" href="https://github.com/gwastro/PyCBC-Tutorials/">https://github.com/gwastro/PyCBC-Tutorials/</a></p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>pip install pycbc
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>pip3 uninstall -y emcee
<span class="o">!</span>pip3 install <span class="nv">emcee</span><span class="o">==</span><span class="m">2</span>.2.0
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/usr/lib/python3/dist-packages/secretstorage/dhcrypto.py:15: CryptographyDeprecationWarning: int_from_bytes is deprecated, use int.from_bytes instead
  from cryptography.utils import int_from_bytes
/usr/lib/python3/dist-packages/secretstorage/util.py:19: CryptographyDeprecationWarning: int_from_bytes is deprecated, use int.from_bytes instead
  from cryptography.utils import int_from_bytes
Found existing installation: emcee 3.1.0
Uninstalling emcee-3.1.0:
  Successfully uninstalled emcee-3.1.0
/usr/lib/python3/dist-packages/secretstorage/dhcrypto.py:15: CryptographyDeprecationWarning: int_from_bytes is deprecated, use int.from_bytes instead
  from cryptography.utils import int_from_bytes
/usr/lib/python3/dist-packages/secretstorage/util.py:19: CryptographyDeprecationWarning: int_from_bytes is deprecated, use int.from_bytes instead
  from cryptography.utils import int_from_bytes
Processing /mnt/data/daten/PostDoc2/home/.cache/pip/wheels/1f/bd/4f/dc67dd006d0065d523da42f802d71d4308ad240d7a0d06126b/emcee-2.2.0-py3-none-any.whl
Requirement already satisfied: numpy in /mnt/data/daten/PostDoc2/home/.local/lib/python3.8/site-packages (from emcee==2.2.0) (1.19.2)
<span class="ansi-red-fg">ERROR: threeml 2.0.2 has requirement emcee&gt;=3, but you&#39;ll have emcee 2.2.0 which is incompatible.</span>
Installing collected packages: emcee
Successfully installed emcee-2.2.0
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pycbc.catalog</span> <span class="kn">import</span> <span class="n">Merger</span>
<span class="kn">from</span> <span class="nn">pycbc.psd</span> <span class="kn">import</span> <span class="n">interpolate</span><span class="p">,</span> <span class="n">inverse_spectrum_truncation</span>
<span class="kn">from</span> <span class="nn">pycbc.frame</span> <span class="kn">import</span> <span class="n">read_frame</span>
<span class="kn">from</span> <span class="nn">pycbc.filter</span> <span class="kn">import</span> <span class="n">highpass</span><span class="p">,</span> <span class="n">resample_to_delta_t</span>
<span class="kn">from</span> <span class="nn">astropy.utils.data</span> <span class="kn">import</span> <span class="n">download_file</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">Merger</span><span class="p">(</span><span class="s2">&quot;GW170817&quot;</span><span class="p">)</span>

<span class="c1"># List of observatories we&#39;ll analyze</span>
<span class="n">ifos</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H1&#39;</span><span class="p">,</span>
        <span class="s1">&#39;V1&#39;</span><span class="p">,</span>
        <span class="s1">&#39;L1&#39;</span><span class="p">,</span>
       <span class="p">]</span>

<span class="c1"># The single template waveform model needs these data products</span>
<span class="n">psds</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">ifo</span> <span class="ow">in</span> <span class="n">ifos</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Processing </span><span class="si">{}</span><span class="s2"> data&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ifo</span><span class="p">))</span>

    <span class="c1"># Download the gravitational wave data for GW170817</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://dcc.ligo.org/public/0146/P1700349/001/</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">1_LOSC_CLN_4_V1-1187007040-2048.gwf&quot;</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">url</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ifo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ifo</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Read the gravitational wave data and do some minimal</span>
    <span class="c1"># conditioning of the data.</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">read_frame</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:LOSC-STRAIN&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ifo</span><span class="p">),</span>
                    <span class="n">start_time</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">time</span> <span class="o">-</span> <span class="mi">260</span><span class="p">),</span>
                    <span class="n">end_time</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">time</span> <span class="o">+</span> <span class="mi">40</span><span class="p">))</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">highpass</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>                     <span class="c1"># Remove low frequency content</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">resample_to_delta_t</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mi">2048</span><span class="p">)</span>      <span class="c1"># Resample data to 2048 Hz</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">time_slice</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">time</span><span class="o">-</span><span class="mi">112</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">time</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span> <span class="c1"># Limit to times around the signal</span>
    <span class="n">data</span><span class="p">[</span><span class="n">ifo</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">to_frequencyseries</span><span class="p">()</span>         <span class="c1"># Convert to a frequency series by taking the data&#39;s FFT</span>

    <span class="c1"># Estimate the power spectral density of the data</span>
    <span class="n">psd</span> <span class="o">=</span> <span class="n">interpolate</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">psd</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">ts</span><span class="o">.</span><span class="n">delta_f</span><span class="p">)</span>
    <span class="n">psd</span> <span class="o">=</span> <span class="n">inverse_spectrum_truncation</span><span class="p">(</span><span class="n">psd</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">psd</span><span class="o">.</span><span class="n">sample_rate</span><span class="p">),</span>
                                      <span class="n">trunc_method</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">,</span>
                                      <span class="n">low_frequency_cutoff</span><span class="o">=</span><span class="mf">20.0</span><span class="p">)</span>
    <span class="n">psds</span><span class="p">[</span><span class="n">ifo</span><span class="p">]</span> <span class="o">=</span> <span class="n">psd</span>




</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Processing H1 data
Processing V1 data
Processing L1 data
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;H1&#39;: &lt;pycbc.types.frequencyseries.FrequencySeries at 0x7fa7e4eac0a0&gt;,
 &#39;V1&#39;: &lt;pycbc.types.frequencyseries.FrequencySeries at 0x7fa7e4eacf70&gt;,
 &#39;L1&#39;: &lt;pycbc.types.frequencyseries.FrequencySeries at 0x7fa7e4eaccd0&gt;}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="mf">0.118700888243E+10</span> <span class="o">-</span> <span class="n">m</span><span class="o">.</span><span class="n">time</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.029999971389770508
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pycbc.inference</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">sampler</span>
<span class="kn">from</span> <span class="nn">pycbc.distributions</span> <span class="kn">import</span> <span class="n">Uniform</span><span class="p">,</span> <span class="n">JointDistribution</span><span class="p">,</span> <span class="n">UniformAngle</span><span class="p">,</span> <span class="n">SinAngle</span><span class="p">,</span> <span class="n">CosAngle</span><span class="p">,</span> <span class="n">UniformLog10</span>

<span class="n">static</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_lower&#39;</span><span class="p">:</span><span class="mf">25.0</span><span class="p">,</span>
          <span class="s1">&#39;approximant&#39;</span><span class="p">:</span><span class="s2">&quot;TaylorF2&quot;</span><span class="p">,</span>
          <span class="s1">&#39;f_final&#39;</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span>
          <span class="s1">&#39;polarization&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
          <span class="s1">&#39;inclination&#39;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span>
         <span class="p">}</span>

<span class="c1"># parameters:</span>
<span class="n">variable</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">&#39;tc&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ra&#39;</span><span class="p">,</span>
    <span class="s1">&#39;dec&#39;</span><span class="p">,</span>
    <span class="s1">&#39;distance&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mchirp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;q&#39;</span><span class="p">,</span>
    <span class="c1">#&#39;inclination&#39;,</span>
    <span class="c1">#&#39;polarization&#39;,</span>
<span class="p">)</span>

<span class="c1"># prior distribution:</span>
<span class="c1"># this is for quick results, narrow ranges</span>
<span class="n">prior</span> <span class="o">=</span> <span class="n">JointDistribution</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span>
    <span class="c1">#SinAngle(inclination=None),</span>
    <span class="n">UniformAngle</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="p">(</span><span class="mf">3.35</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)),</span>
    <span class="n">CosAngle</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.48</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">)),</span>
    <span class="n">UniformLog10</span><span class="p">(</span><span class="n">mchirp</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">q</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">)),</span>
    <span class="n">Uniform</span><span class="p">(</span>
        <span class="n">distance</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="n">tc</span><span class="o">=</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">time</span><span class="o">+.</span><span class="mi">027</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">time</span><span class="o">+</span><span class="mf">0.03</span><span class="p">),</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="c1"># this is the general problem (position: RA/Dec unknown)</span>
<span class="n">prior2</span> <span class="o">=</span> <span class="n">JointDistribution</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span>
    <span class="c1">#SinAngle(inclination=None),</span>
    <span class="n">UniformAngle</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="n">CosAngle</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="n">UniformLog10</span><span class="p">(</span><span class="n">mchirp</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">q</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span>
    <span class="n">Uniform</span><span class="p">(</span>
        <span class="n">distance</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="n">tc</span><span class="o">=</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">time</span><span class="o">+.</span><span class="mi">027</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">time</span><span class="o">+</span><span class="mf">0.03</span><span class="p">),</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">pycbc.transforms</span> <span class="kn">import</span> <span class="n">MchirpQToMass1Mass2</span>

<span class="c1"># use only some of the data (without Virgo):</span>
<span class="n">partial_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="c1">#del partial_data[&#39;V1&#39;]</span>

<span class="c1"># which model to fit to the data</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">MarginalizedPhaseGaussianNoise</span><span class="p">(</span>
    <span class="n">variable</span><span class="p">,</span>
    <span class="n">partial_data</span><span class="p">,</span>
    <span class="n">low_frequency_cutoff</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;H1&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;L1&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;V1&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">},</span>
    <span class="n">high_frequency_cutoff</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;H1&#39;</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;L1&#39;</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;V1&#39;</span><span class="p">:</span><span class="mi">500</span><span class="p">},</span>
    <span class="n">psds</span> <span class="o">=</span> <span class="n">psds</span><span class="p">,</span>
    <span class="n">static_params</span> <span class="o">=</span> <span class="n">static</span><span class="p">,</span>
    <span class="n">prior</span> <span class="o">=</span> <span class="n">prior</span><span class="p">,</span>
    <span class="n">waveform_transforms</span> <span class="o">=</span> <span class="p">[</span><span class="n">MchirpQToMass1Mass2</span><span class="p">()]</span>
<span class="p">)</span>


</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#from pycbc.inference.sampler.emcee import EmceeEnsembleSampler</span>
<span class="c1">#smpl = EmceeEnsembleSampler(model, 200, nprocesses=8)</span>
<span class="c1">#_ = smpl.set_p0() # If we don&#39;t set p0, it will use the models prior to draw initial points!</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#smpl.clear_samples()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Note it may take ~1-3 minutes for this to run</span>
<span class="c1">#smpl.run_mcmc(200)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[78]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#smpl.sampling_params</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#smpl.samples</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#flat_samples = np.transpose([smpl.samples[k].flatten() for k in smpl.sampling_params])</span>
<span class="c1">#flat_samples.shape</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[81]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#import corner</span>
<span class="c1">#corner.corner(flat_samples[10000:,:], labels=smpl.sampling_params);</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[82]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#from pycbc.inference.sampler import DynestySampler</span>
<span class="c1">#sampler = DynestySampler(model, nlive=400)</span>
<span class="c1">#sampler.run()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pycbc.inference.sampler</span> <span class="kn">import</span> <span class="n">UltranestSampler</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sampler</span> <span class="o">=</span> <span class="n">UltranestSampler</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span> <span class="n">log_dir</span><span class="o">=</span><span class="s1">&#39;LIGOcut6&#39;</span><span class="p">,</span>
    <span class="n">frac_remain</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="c1">#min_num_live_points=400</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sampler</span><span class="o">.</span><span class="n">_sampler</span><span class="o">.</span><span class="n">stepsampler</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># if you want to use MCMC for the LRPS, which gives a constant efficiency</span>

<span class="c1">#import ultranest.stepsampler</span>
<span class="c1">#sampler._sampler.stepsampler = ultranest.stepsampler.CubeSliceSampler(nsteps=8)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sampler</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ultranest] Widening roots to 400 live points (have 400 already) ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "047feccc73034016b23fcd065ac96ee2", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ultranest] Explored until L=-2e+05  ..-206840.80 [-206843.3284..-206843.3266]*| it/evals=11339/830543 eff=1.3824% N=400
[ultranest] Likelihood function evaluations: 830543
[ultranest] Writing samples and results to disk ...
[ultranest] Writing samples and results to disk ... done
[ultranest] Reached maximum number of improvement loops.
[ultranest] done iterating.

logZ = -206870.152 +- 0.495
  single instance: logZ = -206870.152 +- 0.254
  bootstrapped   : logZ = -206870.132 +- 0.285
  tail           : logZ = +- 0.405
insert order U test : converged: True correlation: inf iterations

    tc                  1187008882.42889 +- 0.00043
    ra                  3.417 +- 0.019
    dec                 -0.352 +- 0.029
    distance            19.80 +- 0.69
    mchirp              1.197522 +- 0.000051
    q                   1.197 +- 0.063
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sampler</span><span class="o">.</span><span class="n">samples</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;tc&#39;: array([1.18700888e+09, 1.18700888e+09, 1.18700888e+09, ...,
        1.18700888e+09, 1.18700888e+09, 1.18700888e+09]),
 &#39;ra&#39;: array([3.41978869, 3.43912098, 3.41725205, ..., 3.42887199, 3.3872484 ,
        3.39433908]),
 &#39;dec&#39;: array([-0.37233948, -0.37936121, -0.35506555, ..., -0.34928831,
        -0.32375145, -0.33022813]),
 &#39;distance&#39;: array([19.65203942, 20.98632078, 19.47270944, ..., 19.71801802,
        19.586851  , 18.76023911]),
 &#39;mchirp&#39;: array([1.19748953, 1.19743456, 1.19753607, ..., 1.19758356, 1.197509  ,
        1.19748855]),
 &#39;q&#39;: array([1.20575373, 1.27520027, 1.18157495, ..., 1.11690756, 1.24028136,
        1.25668514]),
 &#39;loglikelihood&#39;: array([-206843.66909107, -206844.95721771, -206841.28252703, ...,
        -206842.96750416, -206843.14420791, -206843.08336851])}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">flat_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="n">sampler</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">sampler</span><span class="o">.</span><span class="n">sampling_params</span><span class="p">])</span>
<span class="n">flat_samples</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(11740, 6)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">corner</span>
<span class="n">corner</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">flat_samples</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">sampler</span><span class="o">.</span><span class="n">sampling_params</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/9-ligo-example_25_0.png" src="_images/9-ligo-example_25_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">flat_samples</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="n">m</span><span class="o">.</span><span class="n">time</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.027405977249145508
</pre></div></div>
</div>
<div class="section" id="Exercise-1:-MCMC">
<h2>Exercise 1: MCMC<a class="headerlink" href="#Exercise-1:-MCMC" title="Permalink to this headline">¶</a></h2>
<p>(no points here because this is an outline how to approach the big homework below)</p>
<ul class="simple">
<li><p>Run MCMC for a number of iterations.</p></li>
<li><p>Plot the posterior distribution (with getdist or corner or arviz).</p></li>
<li><p>You constrained the position of this event on the sky (RA, Dec). Compute error bars. Show a picture of that part of the sky with the error ellipse</p>
<ul>
<li><p>(You can use <a class="reference external" href="https://github.com/cds-astro/ipyaladin">https://github.com/cds-astro/ipyaladin</a> or show a image or include a html/script via %%html, as below).</p></li>
</ul>
</li>
<li><p>use the methods learned earlier to investigate whether the chain has converged</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%html</span>

<span class="c">&lt;!-- This example was taken from https://aladin.u-strasbg.fr/AladinLite/doc/API/examples/   --&gt;</span>

<span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#39;stylesheet&#39;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#39;https://aladin.u-strasbg.fr/AladinLite/api/v2/latest/aladin.min.css&#39;</span> <span class="p">/&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#39;text/javascript&#39;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#39;https://code.jquery.com/jquery-1.9.1.min.js&#39;</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#39;utf-8&#39;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#39;aladin-lite-div&#39;</span> <span class="na">style</span><span class="o">=</span><span class="s">&#39;width: 500px;height: 500px;&#39;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#39;text/javascript&#39;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#39;https://aladin.u-strasbg.fr/AladinLite/api/v2/latest/aladin.min.js&#39;</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#39;utf-8&#39;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="c1">// position on the sky:</span>
<span class="nx">ra</span> <span class="o">=</span> <span class="mf">56.87115</span>
<span class="nx">dec</span> <span class="o">=</span> <span class="mf">24.10514</span>
<span class="nx">target</span> <span class="o">=</span> <span class="s1">&#39;56.87115, 24.10514&#39;</span>

<span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">aladin</span><span class="p">(</span><span class="s1">&#39;#aladin-lite-div&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">target</span><span class="o">:</span> <span class="nx">target</span><span class="p">,</span>
    <span class="nx">survey</span><span class="o">:</span> <span class="s1">&#39;P/DSS2/color&#39;</span><span class="p">,</span>
    <span class="nx">zoom</span><span class="o">:</span> <span class="mf">2</span><span class="p">,</span> <span class="nx">showReticle</span><span class="o">:</span> <span class="kc">false</span><span class="p">});</span>
<span class="kd">var</span> <span class="nx">cat</span> <span class="o">=</span> <span class="nx">A</span><span class="p">.</span><span class="nx">catalog</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Some markers&#39;</span><span class="p">,</span> <span class="nx">sourceSize</span><span class="o">:</span> <span class="mf">18</span><span class="p">});</span>
<span class="nx">a</span><span class="p">.</span><span class="nx">addCatalog</span><span class="p">(</span><span class="nx">cat</span><span class="p">);</span>
<span class="nx">cat</span><span class="p">.</span><span class="nx">addSources</span><span class="p">([</span><span class="nx">A</span><span class="p">.</span><span class="nx">marker</span><span class="p">(</span><span class="nx">ra</span><span class="p">,</span> <span class="nx">dec</span><span class="p">,</span> <span class="p">{</span><span class="nx">popupTitle</span><span class="o">:</span> <span class="s1">&#39;Alcyone&#39;</span><span class="p">,</span> <span class="nx">popupDesc</span><span class="o">:</span> <span class="s1">&#39;&lt;em&gt;Bmag:&lt;/em&gt; 2.806&lt;br/&gt;&lt;em&gt;Spectral type:&lt;/em&gt; B7III&lt;br/&gt;More info &lt;a target=&quot;_blank&quot; href=&quot;https://simbad.u-strasbg.fr/simbad/sim-id?Ident=NAME%20ALCYONE&amp;submit=submit&quot;&gt;in Simbad&lt;/a&gt;&#39;</span><span class="p">})]);</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<!-- This example was taken from https://aladin.u-strasbg.fr/AladinLite/doc/API/examples/   -->

<link rel='stylesheet' href='https://aladin.u-strasbg.fr/AladinLite/api/v2/latest/aladin.min.css' />
<script type='text/javascript' src='https://code.jquery.com/jquery-1.9.1.min.js' charset='utf-8'></script>

<div id='aladin-lite-div' style='width: 500px;height: 500px;'></div>
<script type='text/javascript' src='https://aladin.u-strasbg.fr/AladinLite/api/v2/latest/aladin.min.js' charset='utf-8'></script>

<script>

// position on the sky:
ra = 56.87115
dec = 24.10514
target = '56.87115, 24.10514'

var a = A.aladin('#aladin-lite-div', {
    target: target,
    survey: 'P/DSS2/color',
    zoom: 2, showReticle: false});
var cat = A.catalog({name: 'Some markers', sourceSize: 18});
a.addCatalog(cat);
cat.addSources([A.marker(ra, dec, {popupTitle: 'Alcyone', popupDesc: '<em>Bmag:</em> 2.806<br/><em>Spectral type:</em> B7III<br/>More info <a target="_blank" href="https://simbad.u-strasbg.fr/simbad/sim-id?Ident=NAME%20ALCYONE&submit=submit">in Simbad</a>'})]);
</script></div>
</div>
</div>
<div class="section" id="Exercise-2:-Nested-Sampling">
<h2>Exercise 2: Nested Sampling<a class="headerlink" href="#Exercise-2:-Nested-Sampling" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Run the UltranestSampler <code class="docutils literal notranslate"><span class="pre">UltranestSampler(model,</span> <span class="pre">log_dir='my-results-directory',</span> <span class="pre">stepsampling=True)</span></code>. If it is slow, run with MPI (<code class="docutils literal notranslate"><span class="pre">mpiexec</span> <span class="pre">-np</span> <span class="pre">8</span> <span class="pre">python3</span> <span class="pre">myscript.py</span></code>).</p></li>
<li><p>Plot the posterior distributions (with getdist or corner or arviz).</p></li>
<li><p>Compute the information gain for each parameter compared to the prior.</p></li>
<li><p>vary the data sets, by only using one or two of the LIGO/VIRGO detectors: What constraints can be obtained then?</p></li>
</ul>
</div>
<div class="section" id="Big-Homework-(200-points):-Compare-two-sampling-approaches">
<h2>Big Homework (200 points): Compare two sampling approaches<a class="headerlink" href="#Big-Homework-(200-points):-Compare-two-sampling-approaches" title="Permalink to this headline">¶</a></h2>
<p>Select a inference problem with 6-20 parameters. You can either a) Use the LIGO problem above or b) choose your own problem. In that case, use a simplified version.</p>
<p>Implement inference with <strong>at least two of the three</strong> techniques (Importance Sampling, MCMC, Nested Sampling) and run them until convergence. You can use your own implementations, but include at least one modern sampler (for example: stan, ultranest, dynesty, multinest, zeus, emcee, autoemcee, snowline).</p>
<ul class="simple">
<li><p>Compare their performance qualitatively: ease of use, correctness of the result (consistency among the samplers or with published result)</p></li>
<li><p>Compare their performance quantitatively: number of effective samples per wall-clock time</p></li>
<li><p>Make at least one variation of a sampler tuning parameter (for example the number of walkers).</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Johannes Buchner, Francesca Capel

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>